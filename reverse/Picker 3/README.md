Can you figure out how this program works to get the flag?

hint1:Is there any way to modify the function table?
